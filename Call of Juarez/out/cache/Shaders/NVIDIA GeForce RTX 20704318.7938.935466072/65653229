)2ee{.
                        float4 RENDER_TARGET_PARAMS;
                        #include<Functions.hlsl>


                        Texture2D     sBackbuffer;
                        SamplerState     samBackbuffer;
                        Texture2D     sBackbufferBlur;
                        SamplerState     samBackbufferBlur;

                        #if defined(USE_WATERREFLECTION)
                            Texture2D     sReflection;
                            SamplerState     samReflection;
                        #endif
                        #if defined(USE_WATERBORDER)
                            Texture2D     sWaterBorder;
                            SamplerState     samWaterBorder;
                        #endif
                        #if defined(USE_NORMALS)
                            TextureCube sCubemap;
                            SamplerState samCubemap;
                        #endif
                        #if defined(USE_WATERREFLECTION) || defined(USE_NORMALS) || defined(USE_WATERSPECULAR)
                            Texture2D     sNormal0;
                            SamplerState     samNormal0;
                        #endif
                        #if defined(USE_WATERSPECULAR)
                            Texture2D     sGloss;
                            SamplerState     samGloss;
                        #endif


                        struct pixelInput
                        {
                            float4 vPosition    : SV_POSITION;

                            float4 vExtinction  : TEXCOORD0_centroid;
                            float4 vInscattering: TEXCOORD1_centroid;
                            #if defined(USE_WATERREFLECTION)
                                float4  uvReflection    : TEXCOORD2_centroid;
                            #endif
                            #if defined(USE_WATERBORDER)
                                float2  uvWaterBorder   : TEXCOORD3_centroid;
                            #endif
                            #if defined(USE_WATERREFLECTION) || defined(USE_NORMALS) || defined(USE_WATERSPECULAR)
                                float3  vCameraDirWS    : TEXCOORD4_centroid;
                            #endif
                            #if defined(USE_NORMAL0)
                                float2  uvWave0         : TEXCOORD5_centroid;
                            #endif
                            #if defined(USE_NORMAL1)
                                float2  uvWave1         : TEXCOORD6_centroid;
                            #endif
                            #if defined(USE_NORMAL2)
                                float2  uvWave2         : TEXCOORD7_centroid;
                            #endif
                            #if defined(USE_NORMAL3)
                                float2  uvWave3         : TEXCOORD8_centroid;
                            #endif
    //                        float2 uvScreen: VPOS;
                        };

                        void main( in pixelInput input, out float4 output : SV_TARGET )
                        {
                            #if defined(USE_WATERBORDER)
                                float4 vWaterBorder = sWaterBorder.Sample( samWaterBorder, input.uvWaterBorder.xy );
                            #endif

                            #if defined(USE_NORMALS)
                                #if defined(USE_NORMAL0)
                                    float4 vNormalSource = sNormal0.Sample( samNormal0, input.uvWave0.xy );
                                #endif
                                #if defined(USE_NORMAL1)
                                    vNormalSource += sNormal0.Sample( samNormal0, input.uvWave1.xy );
                                #endif
                                #if defined(USE_NORMAL2)
                                    vNormalSource += sNormal0.Sample( samNormal0, input.uvWave2.xy );
                                #endif
                                #if defined(USE_NORMAL3)
                                    vNormalSource += sNormal0.Sample( samNormal0, input.uvWave3.xy );
                                #endif

                                #if defined(USE_NORMAL3)
                                    vNormalSource *= 0.25;
                                #elif defined(USE_NORMAL2)
                                    vNormalSource *= 0.3333;
                                #elif defined(USE_NORMAL1)
                                    vNormalSource *= 0.5;
                                #endif

                                float3 vNormal = vNormalSource.xyz;
                                vNormal.z = sqrt( 1.0 - vNormalSource.x * vNormalSource.x - vNormalSource.y * vNormalSource.y );
                          #endif

    //                        float2 uvTexcoord0 = (input.uvScreen.xy + 0.5) * RENDER_TARGET_PARAMS.xy;
                            float2 uvTexcoord0 = (input.vPosition.xy + 0.5) * RENDER_TARGET_PARAMS.xy;

                            float4 vBack = sBackbuffer.Sample( samBackbuffer, uvTexcoord0.xy );
                            float vDepth = vBack.w - input.vInscattering.w;
                            float vDepthMask =  saturate( linearstep( 0, fWaterDepth, vDepth ) );

                            #if defined(USE_NORMALS)
                                uvTexcoord0 -= vNormalSource.xy * fRefractionPower * vDepthMask;
                            #endif

                            #if defined(FILTERING_16BPP)
                                float4 vBackDeformed = sBackbufferBlur.Sample( samBackbufferBlur, uvTexcoord0.xy );
                            #else
                                float4 vBackDeformed = sBackbuffer.Sample( samBackbuffer, uvTexcoord0.xy );
                            #endif

                            float vBorderMask =  saturate( linearstep( 0, 0.1, vDepth ) );

                            output = lerp( vBack, vBackDeformed, vBorderMask );

                            #if defined(USE_WATERREFLECTION) || defined(USE_NORMALS) || defined(USE_WATERSPECULAR)
                                float3 vCameraDirN = normalize( input.vCameraDirWS );
                            #endif

/*
                          float3 vDeepWaterColor = lerp( 1, vWaterColor.xyz, vDepthMask );
                          vDeepWaterColor = ( 1.0 - vDeepWaterColor.xyz ) * input.vExtinction.xyz - input.vInscattering.xyz;
                          output.xyz *= 1.0-vDeepWaterColor.xyz;
*/

                          float3 vDeepWaterColor = ( 1.0 - vWaterColor.xyz ) * input.vExtinction.xyz - input.vInscattering.xyz;
                          vDeepWaterColor = lerp( 1.0, 1.0 - vDeepWaterColor, vDepthMask );
                          output.xyz *= vDeepWaterColor.xyz;


//                          vDeepWaterColor = vDeepWaterColor.xyz * input.vExtinction.xyz + input.vInscattering.xyz;
//                          output.xyz *= vDeepWaterColor.xyz;
//                            float3 vDeepWaterColor = vWaterColor.xyz * input.vExtinction.xyz + input.vInscattering.xyz;
//                        float3 vDepthColor = lerp( 1, vDeepWaterColor.xyz, vDepthMask );
//                        output.xyz *= vDepthColor.xyz;
//                        output.xyz = lerp( output.xyz, vDeepWaterColor.xyz, vDepthMask );


                            float vOpacityMask = vDepthMask;

                            #if defined(USE_WATERFRESNEL)
                                #if defined(USE_NORMALS)
                                    float vFresnelMask = dot( vNormal.xzy, vCameraDirN );
                                #else
                                    float vFresnelMask = vCameraDirN.y;
                                #endif
                                vFresnelMask = 1 - vFresnelMask;
                                vFresnelMask *= vFresnelMask;
                                vOpacityMask *= vFresnelMask;
                            #endif

                            #if defined(USE_WATERREFLECTION)
                                #if defined(USE_NORMALS)
                                    input.uvReflection.xy += vNormal.xy * fWaterReflDeformPower.xx;
                                #endif
                                float4 vReflectionFlat = sReflection.Sample( samReflection, input.uvReflection.xy/input.uvReflection.z);
                            #endif

                            #if defined(USE_NORMALS)
                                float3 vReflect = reflect( input.vCameraDirWS, vNormal.xzy );
                                float4 vCubemap = sCubemap.Sample( samCubemap, vReflect );
                                #if defined(USE_WATERBORDER)
                                    vCubemap.xyz *= lerp( vAmbient.xyz, vSunColor.xyz * fHDRSunIntensity, vWaterBorder.y  );
                                #else
                                    vCubemap.xyz *= vSunColor.xyz * fHDRSunIntensity;
                                #endif
                            #endif

                            #if defined(USE_NORMALS) && defined(USE_WATERREFLECTION)
                                float vReflectionBlendMask = vCameraDirN.y;
                                vReflectionBlendMask = 1.0 - vReflectionBlendMask;
                                vReflectionBlendMask *= vReflectionBlendMask; //power
                                vReflectionBlendMask *= vReflectionBlendMask; //power
                                float4 vReflection = lerp( vCubemap, vReflectionFlat, vReflectionBlendMask );
                            #elif defined(USE_NORMALS)
                                float4 vReflection = vCubemap;
                            #elif defined(USE_WATERREFLECTION)
                                float4 vReflection = vReflectionFlat;
                            #endif

                            #if defined(USE_NORMALS) || defined(USE_WATERREFLECTION)
                                output.xyz += vReflection.xyz * vOpacityMask * input.vExtinction;
                            #endif


                            #if defined(USE_WATERSPECULAR)
                                float SpecularBlinnShading = saturate( dot( normalize( vSunDir.xyz + vCameraDirN.xyz ), vNormal.xzy ) );
                                float Gloss = saturate( pow( SpecularBlinnShading * 1.05 - 0.025 , 100.0 ) );
    /*
                                #if defined(USE_NORMALS)
                                    float3 vGlossUV = normalize( vNormal.xzy * float3( -5, -5, 2 ) + vSunDir.xyz + vCameraDirN.xyz );
                                #else
                                    float3 vGlossUV = normalize( vSunDir.xyz + vCameraDirN.xyz );
                                #endif
                                float4 vGloss = sGloss.Sample( samGloss, vGlossUV.xz );
    */
                                #if defined(USE_WATERBORDER)
                                    Gloss *= vWaterBorder.y;
                                #endif

    //                            float3 vSpecular = vSunColor * fHDRSunIntensity * vGloss.x  * vOpacityMask * input.vExtinction;
                                float3 vSpecular = vSunColor * fHDRSunIntensity * Gloss  * vOpacityMask * input.vExtinction;
                                output.xyz += vSpecular.xyz;
                            #endif

    //                        output.xyz = output.xyz * input.vExtinction.xyz * input.vInscattering.xyz;
    //                        output.xyz = output.xyz * input.vExtinction * input.vInscattering.xyz;
                            output.w = input.vInscattering.w;
    //                        output = float4(1.0f, 1.0f, 1.0f, 1.0f);
                        }
                    '  DXBCХи}8├Нъл├4╩└O   '     4   И  И  ╝  Ь&  RDEFL     д  	            &  <                            J                           Y                           d                           o                         {                        И        	                С                        Ъ                             samBackbuffer samWaterBorder samCubemap samNormal0 sBackbuffer sWaterBorder sCubemap sNormal0 $Globals лЪ  п   ╝  `          $            <      L     @       d      t  P   @       d      Л  Р   @       d      в  ╨   @       d      ╣    @       d      ╨  P  @       d      ч  Р         <      √  а         <        ░         <        └  @       d      '     @       d      7  @  @       d      F  А  @       d      R  └  @       d      ]     @       d      n  @  @       d      }  А         <      П  Р         <      Ф  а         д      ┤  ░         д      ├  └         <      ╨  ╨         <      ▀  р         <      ю  Ё         <      ¤     @       d        @  @       d        А  @       d      .  └  @       d      ?     @       d      S  @  @       d      i  А  @       d        └  @       d      Х            д      в           д      ▒            <      ╛  0         <      ═  @         <      ▄  P         <      ы  `  @       d      ·  а  @       d        р  @       d           @       d      -  `  @       d      A  а  @       d      W  р  @       d      m     @       d      Г  `         д      П  p         д      Э  А         д      л  Р         д      ╣  а         <      ╟  ░         <      ╒  └  Р       ▄      ь  P	  @       °        Р	         <        а	         <        ░	         <         └	         <      (  ╨	         <      0  р	         <      8  Ё	         <      @   
         <      H  
         <      P   
         <      X  0
         <      a  @
         <      j  P
         <      s  `
         <      |  p
         <      Е  А
         <      О  Р
         <      Ч  а
         <      а  ░
  @       °      й  Ё
         <      ▓            <      ╗    @       °      ─  P  @       °      ═  Р  @       °      ╓  ╨  @       °      ▀           <      ш            <      ё  0         <      ·  @         <        P         <        `         <      %  p         <      ;  А         <      Q  Р         <      g  а         <      }  ░         Ф      д  ╕         Ф      ╣  └         Ф      ╬  ╚         Ф      ч  ╨         Ф         ╪         Ф        р         <      "  Ё         <      +            <      4           <      =            <      F  0         <      ^  @         <      i  P         <      z  `         <      З  p         <      У  А  @       °      Ш  └         д      ┤  ─         д      ┬  ╚         д      ╨  ╠         д      ▐  ╨         д      ю  ╘         д      ■  ╪         д        ▄        д        р         д      4  ф         д      H  ш         д      Y  ь         д      w  Ё         <      Г            <      Р           д      Ь           д      к           └      ╨           └      р            └      Є  $         └        (         └        ,         д      )  0        <      2  @         <      B  P         <      R  `         <      `  p        <      l  А         д      ~  Д         д      Ф  И         д      м  М        д      ╕  Р         д      ├  Ф         д      ╥  Ш        д      у  Ь         д      Ё  а         д        д         д        и         д      0  м         д      F  ░         д      X  └         д      h  ╠         д      {  ╨         д      К  ╘         д      Ъ  ╪         д      й  ▄         д      ╗  р         д      ═  ф         д      ▀  ш         д      ё  ь         д        Ё         д        Ї         д      '  °         д      9  №         д      K            д      U           д      b           д      t           д      Ж           д      Ш           д      к           д      ╝           д      ╬            д      р  $         д      Є  (         д        0         <        @        д        P        <      RENDER_TARGET_PARAMS ллл           SHADOW_XFORM_BIAS_WS_0 л           SHADOW_XFORM_BIAS_WS_1 SHADOW_XFORM_BIAS_WS_2 SHADOW_XFORM_BIAS_MS_0 SHADOW_XFORM_BIAS_MS_1 SHADOW_XFORM_BIAS_MS_2 POSITION_BIAS_SCALE NRM_TAN_TEX_SCALE FOG_PARAMS COMBINED_XFORM MODELVIEW_XFORM INVMODEL_XFORM MODEL_XFORM VIEW_XFORM PROJECTION_XFORM VIEWPROJ_XFORM BACKBUFFER_PARAMS TIME LIGHT_DIR_MS ллл           LIGHT_DIR_MS_0 LIGHT_POS_MS LIGHT_POS_MS_0 LIGHT_POS_MS_1 LIGHT_POS_MS_2 LIGHT_XFORM_MS LIGHT_XFORM_MS_0 LIGHT_XFORM_MS_1 LIGHT_XFORM_MS_2 LIGHT_XFORM_BIAS_MS LIGHT_XFORM_BIAS_MS_0 LIGHT_XFORM_BIAS_MS_1 LIGHT_XFORM_BIAS_MS_2 LIGHT_DIR_WS LIGHT_DIR_WS_0 LIGHT_POS_WS LIGHT_POS_WS_0 LIGHT_POS_WS_1 LIGHT_POS_WS_2 LIGHT_XFORM_WS LIGHT_XFORM_WS_0 LIGHT_XFORM_WS_1 LIGHT_XFORM_WS_2 LIGHT_XFORM_BIAS_WS LIGHT_XFORM_BIAS_WS_0 LIGHT_XFORM_BIAS_WS_1 LIGHT_XFORM_BIAS_WS_2 LIGHT_COLOR LIGHT_COLOR_0 LIGHT_COLOR_1 LIGHT_COLOR_2 CAMERA_POS_MS CAMERA_POS_WS ENV_SH     	       SCATTERING л           CONST_0 CONST_1 CONST_2 CONST_3 CONST_4 CONST_5 CONST_6 CONST_7 CONST_8 CONST_9 CONST_10 CONST_11 CONST_12 CONST_13 CONST_14 CONST_15 CONST_16 CONST_17 CONST_18 CONST_22 CONST_23 CONST_24 CONST_28 CONST_32 CONST_36 CONST_40 CONST_41 CONST_42 CONST_43 CONST_90 TEX_INV_SIZE_NRM_sColor0 TEX_SIZE_NRM_sHeight0 TEX_SIZE_NRM_sHeight1 TEX_SIZE_NRM_sHeight2 TEX_SIZE_NRM_sHeight3 TEX_SIZE_sShadowMap0 лл           TEX_SIZE_sShadowMap1 TEX_SIZE_sShadowMap2 TEX_INV_SIZE_sShadowMap0 TEX_INV_SIZE_sShadowMap1 TEX_INV_SIZE_sShadowMap2 aNGQuad0 aNGQuad1 aNGQuad2 aNGQuad3 vNGRange grass_wind_force_params grass_wave grass_wind_force grass_params ngPlayerPos quad water_level             terrain_inv_x terrain_inv_y terrain_inv_z fShadowmap0Bias fShadowmap1Bias fShadowmap2Bias fHDRSunIntensity fhdrambientintensity fHDRLightsIntensity fHDRSkyIntensity fHDRSelfIlluminationIntensity vGlowParams vColorParams fBulletTime fPlayerDamage iUseWaterReflection лл            iUseWaterBorder iUseWaterSpecular iUseWaterFresnel iUseWaterWavesNumber fGrassSizeFactor vAmbient vTerrainDetail0 vTerrainDetail1 vTerrainCliff vWaterColor fWaterBaseOpacity fWaterReflDeformPower fWaterPlantsDeformPower fWaterDepth fWindPower fFakeBumpPower fRefractionPower fDiffuseGlow fGrassColormapScaleX fGrassColormapScaleY fGrassColormapOffsetX fGrassColormapOffsetY vWindCurrentForce vWindInitialDir fUndergrowthHeight fTopDetailSize fSideDetailSize fDetailsBorder fUndergrowthScale fWaterWave1ScaleX fWaterWave1ScaleY fWaterWave2ScaleX fWaterWave2ScaleY fWaterWave1SpeedX fWaterWave1SpeedY fWaterWave2SpeedX fWaterWave2SpeedY fSkyScale fSkyScaleHDR fSkyCloudsL0Scale fSkyCloudsL0Speed fSkyCloudsL1Scale fSkyCloudsL1Speed fSkyCloudsL2Scale fSkyCloudsL2Speed fSkyHorizonScaleH fSkyHorizonScaleV fSkyBackgroundScale vHorizonColor vSunDir vSunColor Microsoft (R) HLSL Shader Compiler лллISGN°   	      р                   ь                   ь                  ь                  ь                  ь                  ь                  ь                  ь                  SV_POSITION TEXCOORD лллOSGN,                               SV_TARGET ллSHDR╪  @   Ў  d  2        b r    b Є    b 2    b ┬    b r    b 2    b ┬    b 2    e  Є      Y  FО      Ў   X  p     UU  Z   `     X  p    UU  Z   `    X0  p    UU  Z   `    X  p    UU  Z   `    h     E  	Є      ц    F~     `    E  	Є     F    F~     `       2      F      F     E  	Є     ц    F~     `       2      F      F     E  	Є     F    F~     `       2      F      F     8  
R           @    А>      А>    2  
В      
 АA       
      @    А?2  
В      * АA       *      :      K  "      :        В      F    F        В      :      :      2  
r     F     ЎАA       F    E  	Є     F    F~     `    2  r     FВ      ї   ЎП      ▌   FВ АA       у   E  	Є     F    F~     `    2  
r     V    F    FВ      у   8  r     F    F       
2     F     @     ?   ?        8  2     F     FА          E  	Є     F     F~      `        В      :     :АA        В     :      :А      ш   8  В      :      @     A8  r     F    Ў    8  r     F    F    8  ┬          жК      щ   2  
2     ц
АA      Ў    F     E  	Є     F     F~      `        r     FАA      F    2  	r     Ў     F    F       ╥     Й АA       ч   @    А?      А?  А?2  
╥             АA      2  ╥     Ў    АA      @    А?      А?  А?2  	r     F    Ж    F      В      F    F    D  В      :      2  
r     F    Ў     FВ      Ї     В      F    F    D  В      :      8  r     F    Ў             F    F     2  	      
      @  ffЖ?@  ═╠╠╝/        
      8        
      @    ╚B        
      8             
      8  	т      ЎП      ▌   Й      ї   8  r            Ц     8  r      Ў    F     2  	r      F     F    F    6  В      :    >  STATp   6          
                                                                                               И   USE_WATERSPECULAR 1 USE_WATERBORDER 1 USE_NORMALS 1 USE_NORMAL3 1 USE_NORMAL2 1 USE_NORMAL1 1 USE_NORMAL0 1 SHADOW_QUALITY 3 HSM_MODE 1 	             $   &   2   4   @   B   N   P   \   ^   j   l   {   }   Ж    я{    `  `  п   )                                             @                    P   @           	         Р   @                     ╨   @                      @                    P  @    2                 Р      3                 а      '                 ░                       └  @                         @           $          @  @            (          А  @           ,          └  @           0             @           4          @  @    (       8          А      !       9          Р      	       :          а      	       ;          ░             <          └             =          ╨             >         р             ?         Ё             @             @           D          @  @           H         А  @           L         └  @           P             @           T          @  @           X         А  @           \         └  @    
       `                 
       a                       b                        c          0             d         @             e         P             f          `  @           j          а  @           n         р  @           r            @           v          `  @           z          а  @           ~         р  @           В            @           Ж          `             З          p             И         А             Й         Р             К          а             Л          ░             М   	       └  Р    $       Х          P	  @    #       Щ          Р	      #       Ъ         а	      #       Ы         ░	      #       Ь         └	      #       Э         ╨	      #       Ю         р	      #       Я         Ё	      #       а          
      #       б         
      #       в      	    
      #       г      
   0
      #       д         @
      #       е         P
      #       ж         `
      #       з         p
      #       и         А
      #       й         Р
      #       к         а
      #       л         ░
  @    #       п         Ё
      #       ░                #       ▒           @    #       ╡         P  @    #       ╣          Р  @    #       ╜      $   ╨  @    #       ┴      (         #       ┬      )          #       ├      *   0      #       ─      +   @      #       ┼      Z   P      +       ╞          `      ,       ╟          p      ,       ╚          А      ,       ╔          Р      ,       ╩          а      0       ╦          ░      0       ╦          ╕      0       ╠          └      1       ╠          ╚      1       ═          ╨      1       ═          ╪              angquad0    ╬          р             angquad1    ╧          Ё             angquad2    ╨                        angquad3    ╤                       vngrange    ╥                        grass_wind_force_params    ╙          0            
 grass_wave    ╘          @             grass_wind_force    ╒          P             grass_params    ╓          `             ngplayerpos    ╫          p             quad    ╪          А  @           water_level    ▄          └             terrain_inv_x    ▄          ─             terrain_inv_y    ▄          ╚             terrain_inv_z    ▄          ╠             fshadowmap0bias    ▌          ╨             fshadowmap1bias    ▌          ╘             fshadowmap2bias    ▌          ╪             fhdrsunintensity    ▌          ▄             fhdrambientintensity    ▐          р             fhdrlightsintensity    ▐          ф             fhdrskyintensity    ▐          ш             fhdrselfilluminationintensity    ▐          ь             vglowparams    ▀          Ё             vcolorparams    р                        fbullettime    с                       fplayerdamage    с                       iusewaterreflection    с                       iusewaterborder    с                       iusewaterspecular    т                        iusewaterfresnel    т          $             iusewaterwavesnumber    т          (             fgrasssizefactor    т          ,             vambient    у          0             vterraindetail0    ф          @             vterraindetail1    х          P             vterraincliff    ц          `             vwatercolor    ч          p             fwaterbaseopacity    ш          А             fwaterrefldeformpower    ш          Д             fwaterplantsdeformpower    ш          И             fwaterdepth    ш          М            
 fwindpower    щ          Р             ffakebumppower    щ          Ф             frefractionpower    щ          Ш             fdiffuseglow    щ          Ь             fgrasscolormapscalex    ъ          а             fgrasscolormapscaley    ъ          д             fgrasscolormapoffsetx    ъ          и             fgrasscolormapoffsety    ъ          м             vwindcurrentforce    ы          ░             vwindinitialdir    ь          └             fundergrowthheight    ь          ╠             ftopdetailsize    э          ╨             fsidedetailsize    э          ╘             fdetailsborder    э          ╪             fundergrowthscale    э          ▄             fwaterwave1scalex    ю          р             fwaterwave1scaley    ю          ф             fwaterwave2scalex    ю          ш             fwaterwave2scaley    ю          ь             fwaterwave1speedx    я          Ё             fwaterwave1speedy    я          Ї             fwaterwave2speedx    я          °             fwaterwave2speedy    я          №            	 fskyscale    Ё                        fskyscalehdr    Ё                       fskycloudsl0scale    Ё                       fskycloudsl0speed    Ё                       fskycloudsl1scale    ё                       fskycloudsl1speed    ё                       fskycloudsl2scale    ё                       fskycloudsl2speed    ё                       fskyhorizonscaleh    Є                        fskyhorizonscalev    Є          $             fskybackgroundscale    Є          (             vhorizoncolor    є          0             vsundir    Ї          @            	 vsuncolor    ї          P                                                                                  samBackbuffer samWaterBorder
 samCubemap
 samNormal0                         sBackbuffer sWaterBorder sCubemap sNormal0                        